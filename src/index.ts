import autocannon from "autocannon";

const args = process.argv.slice(2);

const url = args
  .find((arg) => arg.startsWith("--url="))
  ?.replace("--url=", "")
  .replace(/\/$/, "");

const testTransactionsMonitoring = () => {
  if (!url) {
    console.log("ERROR: invalid url");
    return;
  }

  const data = [
    "0x038668815ad4247cd10c07a7c4a6b77eb47e4533",
    "0x0391a6185ff8a1ff5474332e8770c759da385802",
    "0x04097f5ebb5588c865f66f7769a688d285924172",
    "0x0445ea3e929746673daf2c9570b88888cf4d0476",
    "0x05dbc72561f2047106077036051aa404c01bac90",
    "0x092524b97bcac86d925064140a2247603ba0c463",
    "0x0d07fe38b2da929d581999a162294bf6081ebecf",
    "0x0f7ce57e7a97f9ddc2eb7497216b8de6f1dc40bc",
    "0x102f1230ed97ee8e3f7ed9c6fda7c855df1fac3a",
    "0x10d3f94b1066a01c8079df9008eab454641f305b",
    "0x10f1dc29d18a504d38c8d2051f5c2f6a88989a1e",
    "0x134a81ea564663a24b786261e1dd991652433ec1",
    "0x13f8e004e777d263b458c554663a2ed8032caff6",
    "0x158022a2d49641dbb3343f7239bee3d1565b98a4",
    "0x158d66c0bd36b1f46dab847ea03a612016acb413",
    "0x17995f40bf64cbd796ab3f29f0c2e4a0fd8e72cb",
    "0x1a803b5bada206e0641b8bc46459ecfe9c9b1503",
    "0x1ad29951197952b62b018560117c3807112055ed",
    "0x1b197e9ed4444a98bc97b32fffbf705a9fff3385",
    "0x1b81da73c4f27650e3125e7c7d9a489b1dc8cc77",
    "0x1c59fbc6987555b7ee3c0adc9494a05264992552",
    "0x1cf8027e612faa6d3cef2b472cf6ea6289e9862d",
    "0x20fe37b25cd05f57c20dd602573c1ddc32265d91",
    "0x210cd4853511a97bbae037d835cee8dbb9d75ee3",
    "0x2674d98180b6038c10ebe8fccb11bf4972194c43",
    "0x2c830d72f322d7ed3420f20d8d3660aa082284bb",
    "0x2dbecbc734403fc3f500ede0f29cd1e51f64b2d9",
    "0x2e0255dee15c8359d3071a6acb072261e0636a61",
    "0x2f3edb4d9492a67504f229ea6604db0f6b692614",
    "0x2fac78278206f1854dd7db405d8c4a6838f1066e",
    "0x312509418b7abeafc2bece42b6bf6ce822fb1d27",
    "0x34eff0a030cc9c5eb0eb2364f76636ec5761a24a",
    "0x35e5d2b74631e60bb7f8c8e6f6cf00defe5c473c",
    "0x366e7c96ef1e09f4ded3f04a0d3e17625dc11eeb",
    "0x374175e941e00a8b3af51144549093b99406eea7",
    "0x39be3779abcd3eaf16d8bd6d28359fe92b15ea13",
    "0x3a4f7884a1a68c0226f64b26b807a8bffaa80479",
    "0x3bf8a5050ab075851f513302edcc66d45009a477",
    "0x4043bfcd947daf6f16bd1c2f5710d1864f90ad8e",
    "0x40b53f9b5a3d468ae2c390c2cd5ea836a749bb5a",
    "0x4723f68cc4f60e947489bcd5071ea090f814715b",
    "0x47464ac1e89261dcdf2c3514e9aee969c39656b5",
    "0x47f3011235d4dcb397ac0cd90f6b4dbae8d13d05",
    "0x4a3402c988015d6814ebb2ba53d81285c3b4d320",
    "0x4c0fe966da510638b5feff9125c9e65057efd86e",
    "0x4ccaaba81e73979f6e5abccc4bd1d00a4fe1b24a",
    "0x4cdca0358bf2a96897674108cc3cdf59cc2a5314",
    "0x4e249c238ac827dac160c5fbf939a45271af947d",
    "0x4f68eaf430904b748a4574f1b5db4e63c649379c",
    "0x4f71c3b751e368b61e270f88af5e518088b0a263",
    "0x520018217d9c7c1e805e240ac6475f1fafea0cd1",
    "0x528ec2bc251abacb304a7550546a7d5ecfa293fd",
    "0x59e8c8bd5c4a87df3215b1f073c557492a4bea28",
    "0x5d60d8e9442fd51ae6ea6fd47e7532810ebb4377",
    "0x5fb858cdd495b81f2ddf5b77245a68c0eeb646f3",
    "0x607dcd117b903ed616570a2ffbdadb821e4f9842",
    "0x6227f43e8d01dbb455dd83995bdde1a459e6dc7a",
    "0x62530dc9356a37cf003b961490d256f555631014",
    "0x6309d485e64c88d943d9e8da5a9d8bf92327f3a0",
    "0x63763e64d758e0c0db42a5c4a6c11a46401d9ba9",
    "0x64ae6624a8e71bf9d9d1042eb6e25fd5050ce6a0",
    "0x663a0d36d0742ad241c5eb4da60d181908eaf601",
    "0x683a675b4a34aab08f87959d2b4354d8fcabdf2e",
    "0x6a90bf7f480a9f86693b9fd0425393465f2b2fcf",
    "0x6d14c8359ead0c5d4e7797b2ab4d57cf65851e68",
    "0x6fae86071a913d66bbc3b10857581370d653dce9",
    "0x70371a6365a1accb4e1503ee786785ae9f47f13b",
    "0x70985447259db08a0f7df75c93a43bec6d8b6a4a",
    "0x70cef86811866654d589595f8c7846feadee47f0",
    "0x7270a0b01f8f091f38f091ed4f6907db9dcd2d8a",
    "0x73438651a84d7288ed0a9b1783148a635cc36c7d",
    "0x7aeaefe59a06c965aa3e93ea31be01d3b625bf18",
    "0x8245ca4d46f59156b7a32b23e4bf505cd782f823",
    "0x82924a911bd8a741be8dd269c0f98c069dc8fea1",
    "0x83e0f860021278ee055bb2933fd3f9c89e7b4a85",
    "0x84e0da05afef1380eb31a06ceb7771031beaa435",
    "0x853f0680b4693747677193a6110785b6907b7a41",
    "0x854edb17828a6a8eb48477ec7b5903152d4b5d70",
    "0x86082ddd98c531d1734787f0eeb04e3099dafef0",
    "0x89dda74c289b70a06e71071206e05675b9d4418a",
    "0x8a1cc324961cb8ac0a8e9aa60db0117c8389f246",
    "0x8b5720e0f9301da5f9b93ba1185e3d9cdf474fe0",
    "0x8cf9e8a2540e6ae48773aa2c9aa8121ddce50101",
    "0x8fe78fdee76ec29d677656e78ff7c3268f81cff8",
    "0x92310538b53cabfc042eb1691bc1b19015a418ed",
    "0x924ebddc1ee7266a3a7d8bbd578a6ba38279176d",
    "0x93a73eb0ff9b3960e0c94d1c8ca0a3fc008c3f39",
    "0x94aa2d8de603e437156f6ac28cdebedb32b9bb95",
    "0x952a3f44dac07c104866011a76a2106d52420d45",
    "0x98099bdaa017146948b3347afc4acfee7294b165",
    "0x99360e979cbfdf03bfd5c9b4097264edff2e538e",
    "0x998d6cabcd98157172096fed8660445641b5595e",
    "0x9bb2e148453b61931a5d1799f9ddb1348d5cb656",
    "0x9c8489f3f402ab50a712f9a1517607daf855e67f",
    "0x9cb95d7bad7f1e323847d81f90c7719dbf9d8acc",
    "0x9dba5562bb58a516e3a3421f8ffb1288ef53a92d",
    "0x9f01511948d8973ee2bd35f25f047077a30cd7d0",
    "0x9fab76ddd5c7499d9df0f2e485b11233a4f1be59",
    "0xa1e988b9257047af7cb1ac05275102c29ab66b05",
    "0xa4b5df00e1f9dee99a5ead87ec49f484f575e79d",
    "0xa4cb04c253af9a1d025f94e7bab99e185aa67f38",
    "0xa95f619340320e9207c05068444a64f8a2992117",
    "0xabea209cea699552c215837797766e7c1a221db0",
    "0xac69558ad27969b4abffc08d0a657d7ff7b4c0c1",
    "0xad89b451915c3037e2b99171fc3f8b7eee9c9720",
    "0xaed4b34c34543c8dd319c2a52332b60525192801",
    "0xb12ca5c0649e3b1fd9e5ec7a568da9d17ad24546",
    "0xb421679aad7deb5664bf006f89570e8baf5fe377",
    "0xb5f1aa17a19446fc4f966bf428e222dd01381efa",
    "0xb6def85a8796dbf101c30b5c8391378d887b2793",
    "0xb752f789f0109e5d87400baf064b3affaf071559",
    "0xb85d34121b68590fa7f4f401ed5dbf9e996dd486",
    "0xba690aa1cc1ac6a3b8c53d78ab4e7e25ff5cffc0",
    "0xbc5976cd8abc38285a95d00c699eee0a3abe54c9",
    "0xbfc64f05ded382e28f42319314b7b70cbba23b30",
    "0xc0c76b3dd63ccce48e85078441c0e966667fd550",
    "0xc0cd39ad70b135a44e563068006335c3472a8237",
    "0xc44bffbf7e10995a86a23cc69bfd6cdff8f945e7",
    "0xc461c146f74f9d9884e172b7cc52005b833bb92b",
    "0xc6e911d2782bc570a5a020faa91f395ba43d5cbf",
    "0xc8ceca8db49c76777c1ff619906e96c48ee1f0a6",
    "0xc972aacfe1e58dd67de69112cd6d98199084df5f",
    "0xc9fa88897ba162862d9073ee2b9be03c65622eed",
    "0xca9e67972c3bae055c4b0f9ba22be6e57168c275",
    "0xce80d54bbe8aee1859f8eab7470441678b0c3509",
    "0xceb3cbcc462f705867b68d04a3b726c995366d16",
    "0xcf43691863c324a49c0148239926075d6604d3ed",
    "0xcf9486e9a4aa470cee12d6cac0958cbabe47c899",
    "0xcfcef358abaf97cfb57923071262cc9af3e23ae0",
    "0xd08df0db7821ffd39df1363b5e2f8f30bba2b5f2",
    "0xd12d02fe36bf484a93333dccb467e6970ef2dee2",
    "0xd2358be2500793a3aa40c1568abf64df32fb8ff1",
    "0xd2916fc55b173dfed702cbbbed42430a08676efc",
    "0xd32e776f46a4affcba0706385994d378b4245899",
    "0xd5c261fb7d94fd9633e36dac61fa73c6dde602a3",
    "0xd5f1218c00b3ecfb7cc531406aac5c6e99148ccf",
    "0xd9328b6c680bc0f427da5a81fcd12b3defc5e7a9",
    "0xd9dff707217580425f7f037d191a11592ee27816",
    "0xda866f1b3a6c17168b5b73293f8ea230b842705a",
    "0xdca439fc5518acc182778360f557ae8b6dc34f99",
    "0xdd6a80734329a2287df87b7bdb8e36dc12e3bd65",
    "0xde96c6bc1a7646a3e166d9213c9a805ee9b5d5c3",
    "0xe2a165e1740a338f3576ab522d0d576a5e6d8048",
    "0xe2dff4d5ff0cadf01e558b484cbbb7c48ca76172",
    "0xe40f86b94a8e6076a73653cfee3961b8afe9db36",
    "0xe4695820a31f0525632c71092cb6ade92462ec18",
    "0xe6cba19dc9bb87a2e08a8e3027356be7a95f98d5",
    "0xe78fb3fb4b17586f6664a1e23c5c20bf9fd7f73b",
    "0xe8d0d8389882d08f3771f0df5c18a1abaf1e1a83",
    "0xebca34017ea417f884febeb6239c659c6af6852e",
    "0xec9f7b1ff9ff17c7a9c6dadccb47e9efb70f546b",
    "0xeeaedf89abcac1b045a43767605f405dbb218f34",
    "0xf14c74a610294ae0ab153da1d03c04a3558c30e3",
    "0xf1ad4082c40aa5361fb9bcb5a50133c3151b11f6",
    "0xf3b2ee3cc44fb3fdb7b424e1273fe6ae87c57dd8",
    "0xf4c48ba3201aab7df77a67cad1f26c6475eba4fe",
    "0xf6cf7a6c86e0b0b01921f79f3e90454ee07337b7",
    "0xf6e170fe16aede55016a9bd32ad12f87ee2b7502",
    "0xf7c824f596c590d58384f28283113999f5f66c6f",
    "0xf838c5424253b82faf5e26646a58c65320a4166f",
    "0xf96d2d3dcb8ad6cad062e876304b0fac42794955",
    "0xf993e358c37e78e24a193ec85c58554e10302503",
    "0xf9fd84f9a8bd246e15540cb3aac0e9fd0bfbe721",
    "0xfbc08c07663a701d76cdcd38092a5f7c7bf3796a",
    "0xfd02dcb40feb87a30bfd044bbfbe34fb21512c1d",
    "0xfe48ed24bb2fc217c1b4b3c92e27a46e28589fb6",
    "0xfe5ab33b12fcdd8c76d48d617d5f8eec1f31f8e6",
  ];

  const getBody = (from: string) =>
    JSON.stringify({
      message: `{"transaction":{"from":"${from}","to":"0xd3c325848d7c6e29b574cb0789998b2ff901f17e","value":"0x0","data":"0x095ea7b3000000000000000000000000c690467799458052122d41287ca8d3b6f606971cffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"},"chainId":"eip155:38"}`,
      signature: "string",
    });

  autocannon(
    {
      url,
      title: "Transactions monitoring",
      connections: 10, //10
      pipelining: 10, //10
      duration: 60, //20
      workers: 4, //4
      requests: data.map((i) => {
        return {
          method: "POST",
          path: "/api/transaction/check",
          body: getBody(i),
          headers: {
            "Content-Type": "application/json",
          },
        };
      }),
    },
    (err, result) => {
      if (err) {
        console.log(err);
      } else {
        console.log(result);
      }
    }
  );
};

testTransactionsMonitoring();
